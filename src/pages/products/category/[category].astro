---
import { getCollection } from 'astro:content';
import CategoryLayout from '../../../layouts/CategoryLayout.astro';

export async function getStaticPaths() {
  const products = await getCollection('products');
  const categories = [...new Set(products.map(p => p.data.category))];

  return categories.map((category) => ({
    params: { category },
    props: {
      category,
      products: products.filter(p => p.data.category === category)
    }
  }));
}

const { category, products } = Astro.props;
---

<CategoryLayout category={category} products={products} />
